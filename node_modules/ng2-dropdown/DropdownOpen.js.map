{"version":3,"sources":["../../src/DropdownOpen.ts"],"names":[],"mappings":"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","file":"DropdownOpen.js","sourcesContent":["import {Directive, ElementRef, OnDestroy, Host, HostListener} from \"@angular/core\";\nimport {Dropdown} from \"./Dropdown\";\n\n@Directive({\n    selector: \"[dropdown-open]\"\n})\nexport class DropdownOpen implements OnDestroy {\n\n    // -------------------------------------------------------------------------\n    // Private Properties\n    // -------------------------------------------------------------------------\n\n    /**\n     * This hack is needed for dropdown not to open and instantly closed\n     */\n    private openedByFocus: boolean = false;\n\n    private closeDropdownOnOutsideClick = (event: MouseEvent) => this.close(event);\n\n    // -------------------------------------------------------------------------\n    // Constructor\n    // -------------------------------------------------------------------------\n\n    constructor(@Host() public dropdown: Dropdown,\n                private elementRef: ElementRef) {\n    }\n\n    // -------------------------------------------------------------------------\n    // Public Methods\n    // -------------------------------------------------------------------------\n\n    @HostListener(\"click\")\n    openDropdown() {\n        if (this.dropdown.activateOnFocus && this.openedByFocus) {\n            this.openedByFocus = false;\n            return;\n        }\n\n        if (this.dropdown.isOpened() && this.dropdown.toggleClick) {\n            this.dropdown.close();\n            document.removeEventListener(\"click\", this.closeDropdownOnOutsideClick);\n        } else {\n            this.dropdown.open();\n            document.addEventListener(\"click\", this.closeDropdownOnOutsideClick, true);\n        }\n    }\n\n    @HostListener(\"keydown\", [\"$event\"])\n    dropdownKeydown(event: KeyboardEvent) {\n        if (event.keyCode === 40) { // down\n            this.openDropdown();\n        }\n    }\n\n    @HostListener(\"focus\")\n    onFocus() {\n        if (!this.dropdown.activateOnFocus) return;\n        this.openedByFocus = true;\n        this.dropdown.open();\n        document.addEventListener(\"click\", this.closeDropdownOnOutsideClick, true);\n    }\n\n    @HostListener(\"blur\", [\"$event\"])\n    onBlur(event: FocusEvent) {\n        if (!this.dropdown.activateOnFocus) return;\n        if (event.relatedTarget &&\n            !this.dropdown.isInClosableZone(<HTMLElement> event.relatedTarget) &&\n            event.relatedTarget !== this.elementRef.nativeElement) {\n\n            this.dropdown.close();\n            document.removeEventListener(\"click\", this.closeDropdownOnOutsideClick);\n        }\n    }\n\n    // -------------------------------------------------------------------------\n    // Lifecycle Methods\n    // -------------------------------------------------------------------------\n\n    ngOnDestroy() {\n        document.removeEventListener(\"click\", this.closeDropdownOnOutsideClick);\n    }\n\n    // -------------------------------------------------------------------------\n    // Private Methods\n    // -------------------------------------------------------------------------\n\n    private close(event: Event) {\n        if (!this.dropdown.isInClosableZone(<HTMLElement> event.target)\n            && event.target !== this.elementRef.nativeElement\n            && !this.elementRef.nativeElement.contains(event.target)) {\n            this.dropdown.close();\n            document.removeEventListener(\"click\", this.closeDropdownOnOutsideClick);\n        }\n    }\n\n}\n"],"sourceRoot":""}